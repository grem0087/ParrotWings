angular.module("user",[]);angular.module("transactions",[]);angular.module("components",["ngRoute","ngStorage","LocalStorageModule","ui.bootstrap","oitozero.ngSweetAlert"]);angular.module("ParrotWings",["user","transactions","components"]),function(n){"use strict";n.module("components").config(function(n,t,i,r,u){n.when("/home",{controller:"HomeCtrl",templateUrl:r.home});n.when("/transactions",{controller:"TransactionsCtrl",templateUrl:r.transactions});n.when("/signin",{controller:"SignInCtrl",templateUrl:r.signin});n.when("/register",{controller:"RegisterCtrl",templateUrl:r.register});n.when("/notfound",{templateUrl:r.notfound});n.when("/signout",{controller:"SignoutCtrl",template:"<div ng-controller='SignoutCtrl'><\/div>"});n.otherwise({redirectTo:"/signin"});t.html5Mode(!0);i.interceptors.push("authInterceptorService");i.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8";i.defaults.transformRequest.unshift(u.$get())});n.module("ParrotWings").run(["authService","$rootScope","$location","appRoutes",function(n,t,i,r){n.fillAuthData();t.$on("$routeChangeStart",function(t,u){n.authentication.isAuth||u.templateUrl!=r.register&&u.templateUrl!=r.home&&u.templateUrl!=r.signin&&i.path("/signin")})}])}(angular),function(n){"use strict";n.module("components").constant("constants",{urls:{signin:"http://localhost:63967/api/users/signin",register:"http://localhost:63967/api/users/register",getBalance:"http://localhost:63967/api/transaction/GetBalance",getLastTransactions:"http://localhost:63967/api/transaction/GetTransactionsList",makeTransaction:"http://localhost:63967/api/transaction/MakeTransaction"},controls:{urls:{userAutocomplete:"http://localhost:63967/api/users/GetUsers"},autocompleteMinCharacters:3}}).constant("appRoutes",{signin:"./views/signin.html",register:"./views/register.html",home:"./views/home.html",transactions:"./views/transactionsIndex.html",notfound:"./views/notfound.html"})}(angular),function(n){"use strict";n.module("components").directive("pwUserAutocomplete",function(){return{scope:{label:"@",required:"@",pattern:"@",type:"@",maxlength:"@"},restrict:"E",templateUrl:"/js/modules/components/controls/autocomplete/pw-user-autocomplete.tpl.html",require:"ngModel",link:function(n,t,i,r){r.$render=function(){if(n.inputString=r.$viewValue,n.inputString)n.getValuesFromServer(n.inputString);else n.onRemove(undefined,!0)};n.$watch("inputString",function(t){t&&t.length>2&&n.getValuesFromServer(t)});n.setTouched=function(){r.$setTouched()}},controller:["$scope","constants","$http",function(n,t,i){n.showItems=!0;n.selectItem=function(t){n.inputString=t.name;n.showItems=!1};n.onRemove=function(){};n.getValuesFromServer=function(r){i.get(t.controls.urls.userAutocomplete+"?input="+r).then(function(t){n.Items=t.data.data;n.showItems=!0})}}]}})}(angular),function(n){"use strict";n.module("components").factory("authInterceptorService",["$q","$location","localStorageService","constants",function(n,t,i){return{request:function(t){var r=i.get("authorizationData");return t.headers["Content-Type"]="application/x-www-form-urlencoded",r&&(t.headers.Authorization="Bearer "+r.token),t||n.when(t)},response:function(t){return(t.status===401||t.status===400)&&console.log("response err"+t),t||n.when(t)},responseError:function(i){return console.log(i),(i.status==-1||i.status==400||i.status==401)&&t.path("/signout"),i.status==404&&t.path("/notfound"),i.data={data:""},i||n.when(i)}}}])}(angular),function(n){"use strict";n.module("components").factory("authService",["$http","$q","localStorageService","constants",function(n,t,i,r){var f={},u={isAuth:!1,userName:"",userId:null},o=function(t){return e(),n.post(r.urls.register,t).then(function(n){return n})},s=function(f){var s="grant_type=password&email="+f.email+"&password="+f.password,o=t.defer();return n.post(r.urls.signin,{email:f.email,password:f.password}).then(function(n){i.set("authorizationData",{token:n.data.access_token,userMail:f.email,userName:n.data.userName,userId:n.data.userId});u.isAuth=!0;u.userName=n.data.userName;u.userId=n.data.userId;o.resolve(n)},function(n){e();o.reject(n)}),o.promise},e=function(){i.remove("authorizationData");u.isAuth=!1;u.userName="";u.userId=null},h=function(){var n=i.get("authorizationData");n&&(u.isAuth=!0,u.userName=n.userName,u.userId=n.userId)};return f.saveRegistration=o,f.login=s,f.logOut=e,f.fillAuthData=h,f.authentication=u,f}])}(angular),function(n){"use strict";n.module("components").factory("commonServices",function(){var n=this;return this.Loader={isLoading:!1},this})}(angular),function(n){"use strict";n.module("components").factory("userService",["$http","$q","localStorageService","constants",function(){return user.updateBalance=function(){},{}}])}(angular);